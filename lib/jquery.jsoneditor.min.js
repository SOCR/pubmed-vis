(function(c){function l(a){return"[object Object]"==Object.prototype.toString.call(a)}function m(a){return"[object Array]"==Object.prototype.toString.call(a)}function j(a,b,f){var d=2==arguments.length;if(-1<b.indexOf(".")){for(var e=a,c=0,g=b.split("."),h=g.length;c<h-1;c++)e=e[g[c]];d?delete e[g[h-1]]:e[g[h-1]]=f}else d?delete a[b]:a[b]=f;return a}function n(a){var b;try{b=JSON.parse(a)}catch(f){b=null,window.console&&console.error("JSON parse failed.")}return b}function p(a){var b;try{b=JSON.stringify(a)}catch(f){b=
"null",window.console&&console.error("JSON stringify failed.")}return b}function r(a){if(0==a.children(".expander").length){var b=c("<span>",{"class":"expander"});b.bind("click",function(){c(this).parent().toggleClass("expanded")});a.prepend(b)}}function q(a,b,f,d){d=d||"";f.children(".item").remove();for(var e in b)if(b.hasOwnProperty(e)){var k=c("<div>",{"class":"item","data-path":d}),g=c(a.propertyElement||"<input>",{"class":"property"}),h=c(a.valueElement||"<input>",{"class":"value"});(l(b[e])||
m(b[e]))&&r(k);k.append(g).append(h);f.append(k);g.val(e).attr("title",e);var j=p(b[e]);h.val(j).attr("title",j);s(k,b[e]);g.change(u(a));h.change(v(a));if(l(b[e])||m(b[e]))q(a,b[e],k,(d?d+".":"")+e)}}function t(a,b){c(a).parentsUntil(b.target).each(function(){var a=c(this).data("path"),a=(a?a+".":a)+c(this).children(".property").val(),d;a:{d=b.original;for(var a=a.split("."),e=0;e<a.length;)if(void 0==(d=d[a[e++]])){d=null;break a}}d=p(d);c(this).children(".value").val(d).attr("title",d)})}function u(a){return function(){var b=
c(this).parent().data("path"),f=n(c(this).next().val()),d=c(this).val(),e=c(this).attr("title");c(this).attr("title",d);j(a.original,(b?b+".":"")+e);d&&j(a.original,(b?b+".":"")+d,f);t(this,a);d||c(this).parent().remove();a.onchange()}}function v(a){return function(){var b=c(this).prev().val(),f=n(c(this).val()||"null"),d=c(this).parent(),e=d.data("path");j(a.original,(e?e+".":"")+b,f);(l(f)||m(f))&&!c.isEmptyObject(f)?(q(a,f,d,(e?e+".":"")+b),r(d)):d.find(".expander, .item").remove();s(d,f);t(this,
a);a.onchange()}}function s(a,b){var c="null";l(b)?c="object":m(b)?c="array":"[object Boolean]"==Object.prototype.toString.call(b)?c="boolean":"[object String]"==Object.prototype.toString.call(b)?c="string":"[object Number]"==Object.prototype.toString.call(b)&&(c="number");a.removeClass(w);a.addClass(c)}c.fn.jsonEditor=function(a,b){b=b||{};a=n(p(a));var f=b.change||function(){};return this.each(function(){var d={target:c(this),onchange:f,original:a,propertyElement:b.propertyElement,valueElement:b.valueElement};
q(d,a,d.target);c(".property, .value",d.target).live("blur focus",function(){c(this).toggleClass("editing")})})};var w="object array boolean number string null"})(jQuery);